@model GPSInformation.Models.IncidenciaVacacion
@{
    ViewData["Title"] = "Detalle de solicitud: " + Model.Folio;
}

<style>
    .col-form-label {
        padding-top: 0rem;
        padding-bottom: 0rem;
        margin-bottom: 0;
        font-size: inherit;
        line-height: 1.5;
    }
</style>

@if ((bool)ViewBag.isPartial == true)
{
    <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30">
        <div>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb breadcrumb-style1 mg-b-10">
                    <li class="breadcrumb-item" aria-current="page"><a href="#" data-rute="@Url.Action("MisSolicitudes","Incidencias", new { id = Model.IdPersona, isPartial = true, Tab = "Vacaciones" })" onclick="GetViewAccess(this)">Lista de solicitudes</a> </li>
                    <li class="breadcrumb-item active" aria-current="page">@ViewData["Title"]</li>
                </ol>
            </nav>
            <h4 class="mg-b-0 tx-spacing--1">@ViewData["Title"]</h4>
        </div>
        <div class="d-none d-md-block">
            <a  class="btn btn-sm pd-x-15 btn-white btn-uppercaser" id="btn_refres_vacaciondet" onclick="GetViewAccess(this)" href="#" data-rute="@Url.Action("Details","IncVacacion", new  { id = Model.IdIncidenciaVacacion, isPartial = true })" >
                <i data-feather="refresh" class="wd-10 mg-r-5"></i>Refrescar
            </a>
            @if ((bool)ViewBag.ShowCancel)
            {
                <a onclick="ValidViewActionAccess(this,'Cancelar esta solicitud')" href="#" data-rute="@Url.Action("Cancelar","IncVacacion", new { id = Model.IdIncidenciaVacacion, isPartial = true  })" class="btn btn-sm pd-x-15 btn-white btn-uppercaser">
                    <i class="icon ion-md-close mg-r-5 tx-16 lh--9"></i>Cancel
                </a>
            }
            @if ((bool)ViewBag.ShowSolCancel)
            {
                <a href="#modal_det_vacaciones" data-toggle="modal" class="btn btn-sm pd-x-15 btn-white btn-uppercaser">
                    <i class="icon ion-md-close mg-r-5 tx-16 lh--9"></i>Solicitar cancelación
                </a>
            }
        </div>
    </div>
}
else
{
    @section MenuTop{
        <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30">
            <div>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb breadcrumb-style1 mg-b-10">
                        <li class="breadcrumb-item active" aria-current="page">@ViewData["Title"]</li>
                    </ol>
                </nav>
                <h4 class="mg-b-0 tx-spacing--1">@ViewData["Title"]</h4>
            </div>
            <div class="d-none d-md-block">
                @if ((bool)ViewBag.ShowCancel)
                {
                    <a href="@Url.Action("Cancelar","IncVacacion", new { id = Model.IdIncidenciaVacacion })" class="btn btn-sm pd-x-15 btn-white btn-uppercaser">
                        <i class="icon ion-md-close mg-r-5 tx-16 lh--9"></i>Cancelar
                    </a>
                }
                @if ((bool)ViewBag.ShowSolCancel)
                {
                    <a href="#modal_det_vacaciones" data-toggle="modal" class="btn btn-sm pd-x-15 btn-white btn-uppercaser">
                        <i class="icon ion-md-close mg-r-5 tx-16 lh--9"></i>Solicitar cancelación
                    </a>
                }
            </div>
        </div>
    }
}
@if (ViewBag.MessageSuccess != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>Estimado usuario!</strong> @ViewBag.MessageSuccess
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">×</span>
        </button>
    </div>
}
<div data-label="Detalle de solicitud" class="df-example demo-forms" id="app_createPermiso">
    <h4 class="bg-light">I. Solicitante</h4>
    @await Component.InvokeAsync("ValidPuestoEnOrganigrama", new { id = Model.IdPersona })
    <h4 class="bg-light">II. Detalle de solicitud</h4>
    <dl class="row">
        <dt class="col-md-2 col-form-label">
            @Html.DisplayNameFor(model => model.IdIncidenciaVacacion)
        </dt>
        <dd class="col-md-4 col-form-label bg-light mb-1">
            @Html.DisplayFor(model => model.IdIncidenciaVacacion)
        </dd>
        <dt class="col-md-2 col-form-label">
            @Html.DisplayNameFor(model => model.Inicio)
        </dt>
        <dd class="col-md-4 col-form-label bg-light mb-1">
            @Html.DisplayFor(model => model.Inicio)
        </dd>
        <dt class="col-md-2 col-form-label">
            @Html.DisplayNameFor(model => model.Fin)
        </dt>
        <dd class="col-md-4 col-form-label bg-light mb-1">
            @Html.DisplayFor(model => model.Fin)
        </dd>
        <dt class="col-md-2 col-form-label">
            @Html.DisplayNameFor(model => model.NoDias)
        </dt>
        <dd class="col-md-4 col-form-label bg-light mb-1">
            @Html.DisplayFor(model => model.NoDias)
        </dd>
        <dt class="col-md-2 col-form-label">
            @Html.DisplayNameFor(model => model.EstatusDescricion)
        </dt>
        <dd class="col-md-4 col-form-label bg-light mb-1">
            <span class="badge badge-@Model.EstatusColor">@Html.DisplayFor(model => model.EstatusDescricion)</span>

        </dd>
        @if (Model.ArchivoScan != "")
        {
            <dt class="col-md-2 col-form-label">
                Formato
            </dt>
            <dd class="col-md-4 col-form-label bg-light mb-1">
                <a href="@Url.Action("DowloadFile","IncVacacion",new  { fileName = Model.ArchivoScan, IdPersona = Model.IdPersona })" title="click aqui para descargar">@Model.ArchivoScan</a>
            </dd>

        }
    </dl>

    <h4 class="bg-light">III. Seguimiento</h4>
    <ul class="steps steps-sm steps-justified">
        @foreach (var item in Model.Proceso.Where(a => a.Tipo == 1))
        {
            @if (item.Revisada)
            {
                <li class="step-item complete">
                    <a href="" class="step-link">
                        <span class="step-icon"><i data-feather="user"></i></span>
                        <div>
                            <span class="step-title">@item.Titulo</span>
                            <span class="step-desc">@item.NombreEmpleado</span>
                            <span class="step-desc @Html.Raw(item.Autorizada ? "text-success" : "text-danger")">@Html.Raw(item.Autorizada ? "Aceptada" : "Rechazada")</span>
                            <span class="step-desc">@string.Format("{0:F}", item.Fecha)</span>
                            <span class="step-desc">@item.Comentarios</span>
                        </div>
                    </a>
                </li>
            }
            else if (!item.Revisada && item.Nivel == Model.Estatus)
            {
                <li class="step-item active">
                    <a href="" class="step-link">
                        <span class="step-icon"><i data-feather="user"></i></span>
                        <div>
                            <span class="step-title">@item.Titulo</span>
                        </div>
                    </a>
                </li>
            }
            else
            {
                <li class="step-item disabled">
                    <a href="" class="step-link">
                        <span class="step-icon"><i data-feather="user"></i></span>
                        <div>
                            <span class="step-title">@item.Titulo</span>
                        </div>
                    </a>
                </li>
            }
        }
    </ul>
    @if (Model.Proceso.Where(a => a.Tipo == 2).Count() == 1)
    {
        <h4 class="bg-light mt-4">IIII. Solicitud de cancelación</h4>
        <dl class="row">
            <dt class="col-md-2 col-form-label">
                Comentarios del solicitante
            </dt>
            <dd class="col-md-10 col-form-label bg-light mb-1">
                @Html.DisplayFor(model => Model.Proceso.Find(a => a.Tipo == 2).Comentarios2)
            </dd>
            <dt class="col-md-2 col-form-label">
                Aprobador
            </dt>
            <dd class="col-md-2 col-form-label bg-light mb-1">
                @Html.DisplayFor(model => Model.Proceso.Find(a => a.Tipo == 2).NombreEmpleado)
            </dd>
            <dt class="col-md-2 col-form-label">
                Revisada
            </dt>
            <dd class="col-md-2 col-form-label bg-light mb-1">
                @Html.DisplayFor(model => Model.Proceso.Find(a => a.Tipo == 2).Revisada)
            </dd>
            <dt class="col-md-2 col-form-label">
                Autorizada
            </dt>
            <dd class="col-md-2 col-form-label bg-light mb-1">
                @Html.DisplayFor(model => Model.Proceso.Find(a => a.Tipo == 2).Autorizada)
            </dd>
            <dt class="col-md-2 col-form-label">
                Comentarios Gestión de Personal
            </dt>
            <dd class="col-md-10 col-form-label bg-light mb-1">
                @Html.DisplayFor(model => Model.Proceso.Find(a => a.Tipo == 2).Comentarios)
            </dd>
        </dl>
    }
    <div class="modal fade" id="modal_det_vacaciones" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body pd-20 pd-sm-30" id="modal_det_vacaciones_content">
                    <form asp-controller="IncVacacion" asp-action="CancelSolCreate" asp-route-isPartial="@Html.Raw((bool)ViewBag.isPartial)" enctype="multipart/form-data" onsubmit="@Html.Raw((bool)ViewBag.isPartial ? "return Gl_form(event)" : "return Gl_form1(event)")">
                        <h3>Solicitar cancelación</h3>
                        <div class="form-group">
                            <label>Comentarios</label>
                            <input type="hidden" name="IdIncidenciaVacacion" value="@Model.IdIncidenciaVacacion" />
                            <textarea name="comentarios" class="form-control"></textarea>
                        </div>
                        <div class="form-group row mg-b-0">
                            <div class="col-sm-12 text-right">
                                <a href="#" data-dismiss="modal" class="btn btn-sm btn-secondary">Cancelar</a>
                                <button type="submit" class="btn btn-sm btn-primary">Guardar solicitud</button>
                            </div>
                        </div>
                    </form>
                </div><!-- modal-body -->
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div><!-- modal -->
</div>

